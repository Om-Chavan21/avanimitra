File: src/components/MapComponent.jsx
----------------------------------------
import React, { useState, useCallback } from "react";
import { GoogleMap, LoadScript, Marker } from "@react-google-maps/api";

const containerStyle = {
    width: "100%",
    height: "400px",
};

const center = {
    lat: 20.5937, // Default latitude
    lng: 78.9629, // Default longitude
};

const MapComponent = ({ onLocationSelect }) => {
    const [markerPosition, setMarkerPosition] = useState(center);
    const [map, setMap] = useState(null);

    const onLoad = useCallback(function callback(map) {
        // This is just an example of getting and using the map instance!!! Hopefully you will get it working & remove setMap hook.
        setMap(map);
    }, []);

    const onUnmount = useCallback(function callback(map) {
        setMap(null);
    }, []);

    const handleMapClick = (event) => {
        const lat = event.latLng.lat();
        const lng = event.latLng.lng();
        setMarkerPosition({ lat, lng });
        onLocationSelect(`https://www.google.com/maps?q=${lat},${lng}`);
    };

    return (
        <LoadScript
            googleMapsApiKey={import.meta.env.VITE_GOOGLE_MAPS_API_KEY}
            libraries={["maps", "marker"]} // Ensure 'marker' library is loaded
        >
            <GoogleMap
                mapContainerStyle={containerStyle}
                center={center}
                zoom={8}
                onClick={handleMapClick}
                onLoad={onLoad}
                onUnmount={onUnmount}
                mapId="DEMO_MAP_ID" // add this line
            >
                {map && (
                    <Marker // Use the Marker component from react-google-maps/api
                        position={markerPosition}
                    />
                )}
            </GoogleMap>
        </LoadScript>
    );
};

export default MapComponent;

----------------------------------------
File: src/pages/CompleteProfilePage.jsx
----------------------------------------
// src/pages/CompleteProfilePage.jsx
import React, { useState } from "react";
import { TextField, Button, Box } from "@mui/material";
import { useLocation, useNavigate } from "react-router-dom";
import axios from "axios";
import MapComponent from "../components/MapComponent"; // Import the new Map component

const CompleteProfilePage = () => {
    const location = useLocation();
    const navigate = useNavigate();
    const [address, setAddress] = useState("");
    const [areaOfResidence, setAreaOfResidence] = useState("");
    const [googleMapsLink, setGoogleMapsLink] = useState(""); // This will now hold the link generated by MapComponent

    // Extract name and WhatsApp number from location state
    const { name, whatsAppNumber } = location.state || {};

    const handleLocationSelect = (link) => {
        setGoogleMapsLink(link);
    };

    const handleSubmit = async () => {
        const payload = {
            name: name,
            phone_number: whatsAppNumber,
            address: address,
            area_of_residence: areaOfResidence,
            google_maps_link: googleMapsLink,
        };

        try {
            await axios.post("http://localhost:8000/customers/", payload);
            alert("Profile completed and data sent successfully!");
            navigate("/opt-in");
        } catch (error) {
            console.error("Error:", error);
            alert("Failed to submit profile. Please try again.");
        }
    };

    return (
        <div className="flex flex-col justify-center items-center h-screen bg-gray-100">
            <Box className="bg-white rounded-lg shadow-xl p-8 w-full max-w-md">
                <h2 className="text-2xl font-semibold mb-6 text-center">
                    Complete Your Profile
                </h2>
                <TextField
                    id="full-name"
                    label="Full Name"
                    variant="outlined"
                    fullWidth
                    margin="normal"
                    value={name}
                    InputProps={{ readOnly: true }}
                />
                <TextField
                    id="whatsapp-mobile"
                    label="WhatsApp Number"
                    variant="outlined"
                    fullWidth
                    margin="normal"
                    value={whatsAppNumber}
                    InputProps={{ readOnly: true }}
                />
                <TextField
                    id="address"
                    label="Address"
                    variant="outlined"
                    fullWidth
                    margin="normal"
                    required
                    value={address}
                    onChange={(e) => setAddress(e.target.value)}
                />
                <TextField
                    id="area-of-residence"
                    label="Area of Residence"
                    variant="outlined"
                    fullWidth
                    margin="normal"
                    required
                    value={areaOfResidence}
                    onChange={(e) => setAreaOfResidence(e.target.value)}
                />

                {/* Include the Map Component */}
                <MapComponent onLocationSelect={handleLocationSelect} />

                <Button
                    variant="contained"
                    color="primary"
                    onClick={handleSubmit}
                    style={{ marginTop: "2rem", color: "white" }}
                    fullWidth
                >
                    Complete Profile
                </Button>
            </Box>
        </div>
    );
};

export default CompleteProfilePage;

----------------------------------------
